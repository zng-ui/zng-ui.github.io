<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Undo service, commands and other types."><title>zng::undo - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="zng" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0 (90b35a623 2024-11-26)" data-channel="1.83.0" data-search-js="search-f0d225181b97f9a4.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="icon" href="https://raw.githubusercontent.com/zng-ui/zng/main/examples/image/res/zng-logo-icon.png"><link rel="stylesheet" href="/doc/zng-material-icons-extensions.css">
</head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../zng/index.html"><img src="https://raw.githubusercontent.com/zng-ui/zng/main/examples/image/res/zng-logo.png" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../zng/index.html"><img src="https://raw.githubusercontent.com/zng-ui/zng/main/examples/image/res/zng-logo.png" alt="logo"></a><h2><a href="../../zng/index.html">zng</a><span class="version">0.13.2</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module undo</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#full-api" title="Full API">Full API</a></li></ul><h3><a href="#modules">Module Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#statics" title="Statics">Statics</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate zng</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../index.html">zng</a></span><h1>Module <span>undo</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/zng/undo.rs.html#1-75">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Undo service, commands and other types.</p>
<p>The <a href="struct.UNDO.html" title="struct zng::undo::UNDO"><code>UNDO</code></a> service can be used to operate the contextual undo stack, you can also use the service
to implement undo/redo for any variable using <a href="struct.UNDO.html#method.watch_var" title="method zng::undo::UNDO::watch_var"><code>UNDO.watch_var</code></a>. The <a href="static.UNDO_CMD.html" title="static zng::undo::UNDO_CMD"><code>UNDO_CMD</code></a> and <a href="static.REDO_CMD.html" title="static zng::undo::REDO_CMD"><code>REDO_CMD</code></a>
commands can be used with <a href="trait.CommandUndoExt.html#tymethod.undo_scoped" title="method zng::undo::CommandUndoExt::undo_scoped"><code>undo_scoped</code></a> to control the focused undo scope. The <a href="history/struct.UndoHistory.html" title="struct zng::undo::history::UndoHistory"><code>history::UndoHistory!</code></a>
widget visualizes the undo or redo stack of the focused undo scope. The example below demonstrates all
of this together to define two widgets that undo and redo and shows the history in a drop-down.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>zng::prelude::<span class="kw-2">*</span>;

<span class="kw">fn </span>undo_combo(op: zng::undo::UndoOp) -&gt; <span class="kw">impl </span>UiNode {
    <span class="kw">let </span>cmd = op.cmd().undo_scoped();

    <span class="macro">Toggle!</span> {
        style_fn = <span class="macro">toggle::ComboStyle!</span>();

        widget::enabled = cmd.flat_map(|c| c.is_enabled());

        child = <span class="macro">Button!</span> {
            child = widget::node::presenter((), cmd.flat_map(|c| c.icon()));
            child_right = <span class="macro">Text!</span>(cmd.flat_map(|c| c.name())), <span class="number">4</span>;
            tooltip = <span class="macro">Tip!</span>(<span class="macro">Text!</span>(cmd.flat_map(|c|c.name_with_shortcut())));
            on_click = <span class="macro">hn!</span>(|a: <span class="kw-2">&amp;</span>gesture::ClickArgs| {
                a.propagation().stop();
                cmd.get().notify();
            });
        };

        checked_popup = <span class="macro">wgt_fn!</span>(|<span class="kw">_</span>| <span class="macro">popup::Popup!</span> {
            child = <span class="macro">zng::undo::history::UndoHistory!</span>(op);
        });
    }
}

<span class="macro">Wrap!</span> {
    spacing = <span class="number">5</span>;
    zng::focus::alt_focus_scope = <span class="bool-val">true</span>;
    children = <span class="macro">ui_vec!</span>[
        undo_combo(zng::undo::UndoOp::Undo),
        undo_combo(zng::undo::UndoOp::Redo),
    ];
}</code></pre></div>
<h2 id="full-api"><a class="doc-anchor" href="#full-api">§</a>Full API</h2>
<p>See <a href="../../zng_ext_undo/index.html" title="mod zng_ext_undo"><code>zng_ext_undo</code></a> for the full undo API.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="history/index.html" title="mod zng::undo::history">history</a></div><div class="desc docblock-short">Undo history widget.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.UNDO.html" title="struct zng::undo::UNDO">UNDO</a></div><div class="desc docblock-short">Undo-redo service.</div></li><li><div class="item-name"><a class="struct" href="struct.UndoActionMergeArgs.html" title="struct zng::undo::UndoActionMergeArgs">Undo<wbr>Action<wbr>Merge<wbr>Args</a></div><div class="desc docblock-short">Arguments for <a href="trait.UndoAction.html#tymethod.merge" title="method zng::undo::UndoAction::merge"><code>UndoAction::merge</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.UndoMix.html" title="struct zng::undo::UndoMix">UndoMix</a></div><div class="desc docblock-short"><strong title='Widget mix-in struct' data-tag='m'><code>m</code></strong>  Undo scope widget mixin.</div></li><li><div class="item-name"><a class="struct" href="struct.UndoStackInfo.html" title="struct zng::undo::UndoStackInfo">Undo<wbr>Stack<wbr>Info</a></div><div class="desc docblock-short">Snapshot of the undo or redo stacks in an <a href="struct.UNDO.html" title="struct zng::undo::UNDO"><code>UNDO</code></a> scope.</div></li><li><div class="item-name"><a class="struct" href="struct.UndoTransaction.html" title="struct zng::undo::UndoTransaction">Undo<wbr>Transaction</a></div><div class="desc docblock-short">Represents captured undo actions in an <a href="struct.UNDO.html#method.transaction" title="method zng::undo::UNDO::transaction"><code>UNDO.transaction</code></a> operation.</div></li><li><div class="item-name"><a class="struct" href="struct.UndoVarModifyTag.html" title="struct zng::undo::UndoVarModifyTag">Undo<wbr>VarModify<wbr>Tag</a></div><div class="desc docblock-short">Identifies var modify requests by undo/redo action.</div></li><li><div class="item-name"><a class="struct" href="struct.WidgetUndoScope.html" title="struct zng::undo::WidgetUndoScope">Widget<wbr>Undo<wbr>Scope</a></div><div class="desc docblock-short">Represents a widget undo scope.</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.UndoFullOp.html" title="enum zng::undo::UndoFullOp">Undo<wbr>Full<wbr>Op</a></div><div class="desc docblock-short">Represents a full undo/redo action.</div></li><li><div class="item-name"><a class="enum" href="enum.UndoOp.html" title="enum zng::undo::UndoOp">UndoOp</a></div><div class="desc docblock-short">Represents an undo/redo action.</div></li></ul><h2 id="statics" class="section-header">Statics<a href="#statics" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="static" href="static.CLEAR_HISTORY_CMD.html" title="static zng::undo::CLEAR_HISTORY_CMD">CLEAR_<wbr>HISTORY_<wbr>CMD</a></div><div class="desc docblock-short">Represents the <strong>clear history</strong> action.</div></li><li><div class="item-name"><a class="static" href="static.REDO_CMD.html" title="static zng::undo::REDO_CMD">REDO_<wbr>CMD</a></div><div class="desc docblock-short">Represents the <strong>redo</strong> action.</div></li><li><div class="item-name"><a class="static" href="static.UNDO_CMD.html" title="static zng::undo::UNDO_CMD">UNDO_<wbr>CMD</a></div><div class="desc docblock-short">Represents the <strong>undo</strong> action.</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.CommandUndoExt.html" title="trait zng::undo::CommandUndoExt">Command<wbr>Undo<wbr>Ext</a></div><div class="desc docblock-short">Undo extension methods for commands.</div></li><li><div class="item-name"><a class="trait" href="trait.RedoAction.html" title="trait zng::undo::RedoAction">Redo<wbr>Action</a></div><div class="desc docblock-short">Represents a single redo action.</div></li><li><div class="item-name"><a class="trait" href="trait.UndoAction.html" title="trait zng::undo::UndoAction">Undo<wbr>Action</a></div><div class="desc docblock-short">Represents a single undo action.</div></li><li><div class="item-name"><a class="trait" href="trait.UndoInfo.html" title="trait zng::undo::UndoInfo">Undo<wbr>Info</a></div><div class="desc docblock-short">Metadata info about an action registered for undo action.</div></li><li><div class="item-name"><a class="trait" href="trait.UndoSelect.html" title="trait zng::undo::UndoSelect">Undo<wbr>Select</a></div><div class="desc docblock-short">Selects actions to undo or redo.</div></li><li><div class="item-name"><a class="trait" href="trait.UndoSelector.html" title="trait zng::undo::UndoSelector">Undo<wbr>Selector</a></div><div class="desc docblock-short">Represents a type that can select actions for undo or redo once.</div></li><li><div class="item-name"><a class="trait" href="trait.WidgetInfoUndoExt.html" title="trait zng::undo::WidgetInfoUndoExt">Widget<wbr>Info<wbr>Undo<wbr>Ext</a></div><div class="desc docblock-short">Undo extension methods for widget info.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.undo_enabled.html" title="fn zng::undo::undo_enabled">undo_<wbr>enabled</a></div><div class="desc docblock-short"><strong title='Property function' data-tag='P'><code>P</code></strong>  Enable or disable undo inside the widget.</div></li><li><div class="item-name"><a class="fn" href="fn.undo_interval.html" title="fn zng::undo::undo_interval">undo_<wbr>interval</a></div><div class="desc docblock-short"><strong title='Property function' data-tag='P'><code>P</code></strong>  Sets the time interval that undo and redo cover each call for undo handlers in the widget and descendants.</div></li><li><div class="item-name"><a class="fn" href="fn.undo_limit.html" title="fn zng::undo::undo_limit">undo_<wbr>limit</a></div><div class="desc docblock-short"><strong title='Property function' data-tag='P'><code>P</code></strong>  Sets the maximum length for undo/redo stacks in the widget and descendants.</div></li><li><div class="item-name"><a class="fn" href="fn.undo_scope.html" title="fn zng::undo::undo_scope">undo_<wbr>scope</a></div><div class="desc docblock-short"><strong title='Property function' data-tag='P'><code>P</code></strong>  Sets if the widget is an undo scope.</div></li></ul></section></div></main></body></html>